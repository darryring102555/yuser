function deep(a){var c,b="|";for(c=1;a>c;++c)b+="—";return a>1?b+":":""}function treeToArr(a,b,c){var d,e,f,g;if(b=b?b+"-":"",c=c?c+1:1,d=[],"object"==typeof a)for(e in a)if("object"!=typeof a[e])d[d.length]={key:b+e,k:e,type:typeof a[e],value:a[e],deep:c};else for(d[d.length]={key:b+e,k:e,type:typeof a[e],value:"array",deep:c},f=treeToArr(a[e],b+e,c),g=0;g<f.length;g++)d[d.length]=f[g];else d[d.length]={key:b,k:0,type:typeof a,value:a,deep:c};return d}function parseURL(a){var b=document.createElement("a");return b.href=a,{source:a,protocol:b.protocol.replace(":",""),host:b.hostname,port:b.port,query:b.search,params:function(){for(var f,a={},c=b.search.replace(/^\?/,"").split("&"),d=c.length,e=0;d>e;e++)c[e]&&(f=c[e].split("="),a[f[0]]=f[1]);return a}(),file:(b.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:b.hash.replace("#",""),path:b.pathname.replace(/^([^\/])/,"/$1"),relative:(b.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:b.pathname.replace(/^\//,"").split("/")}}function dumps(){for(var a=0;a<arguments.length;++a)console.log(arguments[a])}$(function(j){function handParams(){var b,c,a=$("#api");return a.attr("method",$('[name="tool_m_type"]:input:checked').val()),b=$('[name="p_name[]"]:not(:hidden)'),c="",1!=$('[name="tool_json"]:input:checked').val()?($('[name="p_value[]"]:not(:hidden)').each(function(a,d){var e=$.trim($(b[a]).val()),f=$(d).val();e&&$.trim(f)&&(c+='<input type="hidden" name="'+e+'" value="'+f+'">')}),$("#api").html(c),!0):($('[name="p_value[]"]:not(:hidden)').each(function(a,d){var e=$.trim($(b[a]).val()),f=$(d).val();e&&$.trim(f)&&(c+=-1!=f.indexOf("}")||-1!=f.indexOf("]")?'"'+e+'":'+f+",":'"'+e+'":"'+f+'",')}),","==c.substr(c.length-1,1)&&(c=c.substring(0,c.length-1)),0==c.indexOf(",")&&(c=c.substr(1,c.length)),c="{"+c+"}",$('form input[name="params"]').val(c),void 0)}""!=parseURL(window.location.href)["port"]?$("#api").attr("action","http://"+parseURL(window.location.href)["host"]+":"+parseURL(window.location.href)["port"]+$("#api").attr("action")):$("#api").attr("action","http://"+parseURL(window.location.href)["host"]+$("#api").attr("action"));var html=template("table",{data:interfaces,select:[0,0]});window.document.getElementById("content").innerHTML=html,template.helper("deep",deep),$(".add").click(function(){var a=template("tr",{});$("table").append(a)}),$(".reset").click(function(){$("#tb").find('[name="p_value[]"]').val([""])}),$(".submit").click(function(){var a,b,c,d,e,f;handParams(),a=$("#api"),b=$.trim($("#interface-url").attr("data-url")),c=a.attr("action"),b=c+b,d=parseURL(b)["params"],e="";for(f in d)e+='<input type="hidden" name="'+$.trim(f)+'" value="'+d[f]+'">';a.append(e),a.attr("action",b),a.attr("method","get").submit(),a.attr("action",c)}),$(document).on("click","#look",function(){var $form,url,obj;handParams(),$form=$("#api"),url=$.trim($("#interface-url").attr("data-url")),url=$form.attr("action")+url,obj={type:$form.attr("method"),url:url,data:$form.serialize(),success:function(data){dumps(data);try{eval("data = "+data+";")}catch(e){if("object"!=typeof data)return alert("返回数据结构不正确!"),!1}data.data=treeToArr(data,""),data.ruesult_info=interfaces[$('[name="tool_classify"]').val()]["interface"][$('[name="tool_interface"]').val()]["result_info"];var html=template("result-tab",data);window.document.getElementById("result").innerHTML=html},error:function(){alert("网络错误!")}},1==$('[name="tool_jsonp"]:input:checked').val()&&(obj.dataType="jsonp"),$.ajax(obj)}),$(document).on("change",'[name="tool_classify"]',function(){var a=template("table",{data:interfaces,select:[$(this).val(),0]});window.document.getElementById("content").innerHTML=a}),$(document).on("change",'[name="tool_interface"]',function(){var a=template("table",{data:interfaces,select:[$('[name="tool_classify"]').val(),$(this).val()]});window.document.getElementById("content").innerHTML=a,window.document.getElementById("result").innerHTML=""})});