define(["jquery","common","validate_cn","ztree"],function(a,b){function f(a,b){return!b.isParent}function g(){for(var a in e)e[a]()}var e={};return e.checkd=b.checkd,e.ztree=function(){var e,g,b={view:{showIcon:f,showIcon:!1},data:{simpleData:{enable:!0,pIdKey:"parent_id"},key:{url:"javascript:void(0);"}},callback:{onClick:function(b,c,d){a(".ts-tree").val([d.id])}}},c=window[TS.config.data_var]["data"]||[],d=window[TS.config.data_var]["tree"];d[0]["open"]=1,a.fn.zTree.init(a("#tree"),b,d),e=a.fn.zTree.getZTreeObj("tree"),g=e.getNodeByParam("id",c["parent_id"],null),e.selectNode(g)},e.verify=function(){a("#edit").validate({rules:{name:{required:!0},parent_id:{number:!0}},messages:{name:{required:"true"},parent_id:{number:"true"}},errorPlacement:function(a,b){var c=b.parents("dl");c.find(".field_info").hide(),c.find(".error_message").append(a)}})},b.onclick('#edit [type="submit"]:button',function(){var c=a("#edit");c.valid()?this.ajax(c.attr("action"),function(a){0===a.code&&(a.id?c.find('[type="reset"]:button').trigger("click"):window.setTimeout(function(){window.location.href=U("index")},2e3)),b.alt(a)},c.serialize(),"post"):this.data("click",0)}),{init:g}});