define(['jquery', 'lodash', 'backbone'], function () { var V; requirejs(['joint'], function (joint) { V = joint.V; var graph = new joint.dia.Graph; /* 画板 */ var paper = new joint.dia.Paper({ el: $('#paper'), width: '100%', height: 4000, gridSize: 20, model: graph, linkConnectionPoint: joint.util.shapePerimeterConnectionPoint }); /* 数据库开始 */ joint.shapes.basic.Cylinder = joint.shapes.basic.Generic.extend({ markup: '<g class="rotatable"><g class="scalable"><path/></g><text/></g>', defaults: joint.util.deepSupplement({ type: 'basic.Cylinder', size: { width: 40, height: 40 }, attrs: { 'path': { fill: '#FFFFFF', stroke: '#cbd2d7', 'stroke-width': 3, d: [ 'M 0 10 C 10 5, 30 5, 40 10 C 30 15, 10 15, 0 10', 'L 0 20', 'C 10 25, 30 25, 40 20', 'L 40 10' ].join(' ') }, 'text': { fill: '#435460', 'font-size': 14, text: '', 'ref-x': .5, 'ref-y': .7, ref: 'path', 'y-alignment': 'middle', 'text-anchor': 'middle', fill: 'black', 'font-family': 'Arial, helvetica, sans-serif' } } }, joint.shapes.basic.Generic.prototype.defaults) }); var cylinder = new joint.shapes.basic.Cylinder({ position: { x: 2, y: 75 }, size: { width: 180, height: 150 }, attrs: { text: { text: 'yuser数据库' } } }); graph.addCell(cylinder); /* 数据库结束 */ var t_table = new joint.shapes.basic.Rect({ position: { x: 200, y: 2 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_table表' } } }); graph.addCell(t_table); var t_table_relation = new joint.shapes.basic.Rhombus({ position: { x: 450, y: 202 }, size: { width: 160, height: 90 }, attrs: { text: { text: 't_table_relation表', 'font-size': 14 } } }); graph.addCell(t_table_relation);var t_user = new joint.shapes.basic.Rect({ position: { x: 200, y: 402 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_user表' } } }); graph.addCell(t_user); var t_admin_user = new joint.shapes.basic.Rect({ position: { x: 200, y: 602 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_admin_user表' } } }); graph.addCell(t_admin_user); var t_role = new joint.shapes.basic.Rect({ position: { x: 200, y: 802 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_role表' } } }); graph.addCell(t_role); var t_admin_user_role = new joint.shapes.basic.Rhombus({ position: { x: 450, y: 1002 }, size: { width: 160, height: 90 }, attrs: { text: { text: 't_admin_user_role表', 'font-size': 14 } } }); graph.addCell(t_admin_user_role);var t_power = new joint.shapes.basic.Rect({ position: { x: 200, y: 1202 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_power表' } } }); graph.addCell(t_power); var t_role_power = new joint.shapes.basic.Rhombus({ position: { x: 450, y: 1402 }, size: { width: 160, height: 90 }, attrs: { text: { text: 't_role_power表', 'font-size': 14 } } }); graph.addCell(t_role_power);var t_admin_user_log = new joint.shapes.basic.Rect({ position: { x: 200, y: 1602 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_admin_user_log表' } } }); graph.addCell(t_admin_user_log); var t_city = new joint.shapes.basic.Rect({ position: { x: 200, y: 1802 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_city表' } } }); graph.addCell(t_city); var t_category = new joint.shapes.basic.Rect({ position: { x: 200, y: 2002 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_category表' } } }); graph.addCell(t_category); var t_goods = new joint.shapes.basic.Rect({ position: { x: 200, y: 2202 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_goods表' } } }); graph.addCell(t_goods); var t_brand = new joint.shapes.basic.Rect({ position: { x: 200, y: 2402 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_brand表' } } }); graph.addCell(t_brand); var t_member_rank = new joint.shapes.basic.Rect({ position: { x: 200, y: 2602 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_member_rank表' } } }); graph.addCell(t_member_rank); var t_supplier = new joint.shapes.basic.Rect({ position: { x: 200, y: 2802 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_supplier表' } } }); graph.addCell(t_supplier); var t_goods_discount = new joint.shapes.basic.Rhombus({ position: { x: 450, y: 3002 }, size: { width: 160, height: 90 }, attrs: { text: { text: 't_goods_discount表', 'font-size': 14 } } }); graph.addCell(t_goods_discount);var t_discount = new joint.shapes.basic.Rect({ position: { x: 200, y: 3202 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_discount表' } } }); graph.addCell(t_discount); var t_activity = new joint.shapes.basic.Rect({ position: { x: 200, y: 3402 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_activity表' } } }); graph.addCell(t_activity); var t_win_list = new joint.shapes.basic.Rect({ position: { x: 200, y: 3602 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_win_list表' } } }); graph.addCell(t_win_list); var t_award = new joint.shapes.basic.Rect({ position: { x: 200, y: 3802 }, size: { width: 140, height: 90 }, attrs: { text: { text: 't_award表' } } }); graph.addCell(t_award); var l6_1 = new joint.dia.Link({ source: { id: t_table_relation.id }, target: { id: t_table.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l6_2 = new joint.dia.Link({ source: { id: t_table_relation.id }, target: { id: t_table.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l23 = new joint.dia.Link({ source: { id: t_user.id }, target: { id: t_admin_user.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l24 = new joint.dia.Link({ source: { id: t_user.id }, target: { id: t_admin_user_log.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l25 = new joint.dia.Link({ source: { id: t_admin_user.id }, target: { id: t_user.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }});var l26_1 = new joint.dia.Link({ source: { id: t_admin_user_role.id }, target: { id: t_admin_user.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l26_2 = new joint.dia.Link({ source: { id: t_admin_user_role.id }, target: { id: t_role.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l27_1 = new joint.dia.Link({ source: { id: t_role_power.id }, target: { id: t_role.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l27_2 = new joint.dia.Link({ source: { id: t_role_power.id }, target: { id: t_power.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l28 = new joint.dia.Link({ source: { id: t_category.id }, target: { id: t_goods.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l29 = new joint.dia.Link({ source: { id: t_goods.id }, target: { id: t_category.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l30 = new joint.dia.Link({ source: { id: t_brand.id }, target: { id: t_goods.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l31 = new joint.dia.Link({ source: { id: t_goods.id }, target: { id: t_brand.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l32 = new joint.dia.Link({ source: { id: t_supplier.id }, target: { id: t_goods.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l33 = new joint.dia.Link({ source: { id: t_goods.id }, target: { id: t_supplier.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l34 = new joint.dia.Link({ source: { id: t_goods_discount.id }, target: { id: t_goods.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l35 = new joint.dia.Link({ source: { id: t_member_rank.id }, target: { id: t_discount.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }});var l36_1 = new joint.dia.Link({ source: { id: t_goods_discount.id }, target: { id: t_goods.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l36_2 = new joint.dia.Link({ source: { id: t_goods_discount.id }, target: { id: t_discount.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l38 = new joint.dia.Link({ source: { id: t_discount.id }, target: { id: t_member_rank.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l39 = new joint.dia.Link({ source: { id: t_activity.id }, target: { id: t_win_list.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l40 = new joint.dia.Link({ source: { id: t_win_list.id }, target: { id: t_activity.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l41 = new joint.dia.Link({ source: { id: t_win_list.id }, target: { id: t_user.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); var l42 = new joint.dia.Link({ source: { id: t_win_list.id }, target: { id: t_award.id }, attrs: { '.marker-source': { d: 'M 10 0 L 0 5 L 10 10 z', transform: 'scale(0.001)' }, '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }}); graph.addCells([ l6_1,l6_2 , l23 , l24 , l25 ,l26_1,l26_2 ,l27_1,l27_2 , l28 , l29 , l30 , l31 , l32 , l33 , l34 , l35 ,l36_1,l36_2 , l38 , l39 , l40 , l41 , l42 ]); }); var bind = {}; function init() { for (var i in bind) { bind[i](); } } return { init: init }; });